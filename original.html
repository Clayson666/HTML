<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Vitaclick - Smart Wellness</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            min-height: 100vh;
        }

        .screen {
            display: none;
            min-height: 100vh;
            padding: 24px;
            justify-content: center;
            align-items: center;
        }

        .screen.active {
            display: flex;
        }

        .bg-teal {
            background: linear-gradient(135deg, #ccfbf1 0%, #a7f3d0 100%);
        }

        .bg-purple {
            background: linear-gradient(135deg, #fae8ff 0%, #fbcfe8 100%);
        }

        .bg-green {
            background: linear-gradient(135deg, #d1fae5 0%, #a7f3d0 100%);
        }

        .card {
            background: white;
            border-radius: 24px;
            box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.25);
            padding: 40px;
            max-width: 600px;
            width: 100%;
        }

        .card-center {
            text-align: center;
        }

        .icon-circle {
            width: 96px;
            height: 96px;
            background: linear-gradient(135deg, #2dd4bf 0%, #10b981 100%);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 24px;
            box-shadow: 0 10px 30px rgba(45, 212, 191, 0.3);
        }

        .icon-circle.small {
            width: 64px;
            height: 64px;
        }

        .icon-circle.purple {
            background: linear-gradient(135deg, #a78bfa 0%, #ec4899 100%);
        }

        .icon-circle.green {
            background: linear-gradient(135deg, #34d399 0%, #10b981 100%);
        }

        .icon-circle svg {
            width: 48px;
            height: 48px;
            stroke: white;
            fill: none;
            stroke-width: 2;
        }

        .icon-circle.small svg {
            width: 32px;
            height: 32px;
        }

        .logo-img {
            width: 100%;
            height: 100%;
            object-fit: contain;
            padding: 8px;
        }

        h1 {
            font-size: 48px;
            font-weight: bold;
            color: #1f2937;
            margin-bottom: 12px;
        }

        h2 {
            font-size: 32px;
            font-weight: bold;
            color: #1f2937;
            margin-bottom: 32px;
        }

        .brand {
            font-size: 24px;
            font-weight: 600;
            background: linear-gradient(135deg, #14b8a6 0%, #10b981 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 8px;
        }

        .subtitle {
            color: #6b7280;
            font-size: 14px;
            text-transform: uppercase;
            letter-spacing: 0.1em;
            margin-bottom: 32px;
        }

        .btn {
            width: 100%;
            padding: 16px 32px;
            font-size: 18px;
            font-weight: bold;
            color: white;
            background: linear-gradient(135deg, #14b8a6 0%, #10b981 100%);
            border: none;
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .btn:hover {
            transform: scale(1.05);
            box-shadow: 0 10px 30px rgba(20, 184, 166, 0.4);
        }

        .btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none;
        }

        .btn-purple {
            background: linear-gradient(135deg, #a855f7 0%, #ec4899 100%);
        }

        .btn-purple:hover {
            box-shadow: 0 10px 30px rgba(168, 85, 247, 0.4);
        }

        .btn-green {
            background: linear-gradient(135deg, #10b981 0%, #059669 100%);
        }

        .btn-gray {
            background: linear-gradient(135deg, #6b7280 0%, #4b5563 100%);
        }

        textarea {
            width: 100%;
            height: 192px;
            padding: 16px;
            padding-right: 64px;
            border: 2px solid #e5e7eb;
            border-radius: 12px;
            font-size: 16px;
            font-family: inherit;
            resize: none;
            outline: none;
            margin-bottom: 24px;
        }

        textarea:focus {
            border-color: #14b8a6;
            box-shadow: 0 0 0 3px rgba(20, 184, 166, 0.1);
        }

        textarea:disabled {
            background: #f9fafb;
        }

        input {
            width: 100%;
            padding: 16px;
            border: 2px solid #e5e7eb;
            border-radius: 12px;
            font-size: 16px;
            font-family: inherit;
            outline: none;
        }

        input:focus {
            border-color: #14b8a6;
            box-shadow: 0 0 0 3px rgba(20, 184, 166, 0.1);
        }

        .input-purple:focus {
            border-color: #a855f7;
            box-shadow: 0 0 0 3px rgba(168, 85, 247, 0.1);
        }

        .input-green:focus {
            border-color: #10b981;
            box-shadow: 0 0 0 3px rgba(16, 185, 129, 0.1);
        }

        .form-group {
            margin-bottom: 24px;
        }

        .form-group > div {
            position: relative;
        }

        .form-group .mic-button {
            bottom: 8px;
            right: 8px;
            width: 48px;
            height: 48px;
        }

        .textarea-container {
            position: relative;
            margin-bottom: 24px;
        }

        .mic-button {
            position: absolute;
            bottom: 40px;
            right: 16px;
            width: 56px;
            height: 56px;
            background: linear-gradient(135deg, #14b8a6 0%, #10b981 100%);
            border: none;
            border-radius: 50%;
            cursor: pointer;
            transition: all 0.3s;
            box-shadow: 0 4px 12px rgba(20, 184, 166, 0.3);
        }

        .mic-button:hover {
            transform: scale(1.1);
        }

        .mic-button:disabled {
            background: #ef4444;
            cursor: not-allowed;
            animation: pulse 1s infinite;
        }

        .mic-button svg {
            width: 24px;
            height: 24px;
            stroke: white;
            fill: none;
            stroke-width: 2;
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.1); }
        }

        .alert {
            padding: 20px;
            border-radius: 12px;
            margin-bottom: 24px;
        }

        .alert-red {
            background: #fef2f2;
            border: 2px solid #fca5a5;
        }

        .alert-teal {
            background: #f0fdfa;
            border-left: 4px solid #14b8a6;
        }

        .alert-blue {
            background: #eff6ff;
            border-left: 4px solid #3b82f6;
        }

        .alert-purple {
            background: #faf5ff;
            border-left: 4px solid #a855f7;
        }

        .alert-title {
            font-weight: bold;
            margin-bottom: 8px;
            color: #1f2937;
        }

        .alert-text {
            color: #4b5563;
            font-size: 14px;
            line-height: 1.6;
        }

        .recording-banner {
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 20px;
            background: #fef2f2;
            border: 2px solid #fca5a5;
            border-radius: 12px;
            margin-bottom: 16px;
        }

        .recording-indicator {
            display: flex;
            align-items: center;
            margin-bottom: 8px;
        }

        .recording-dot {
            width: 16px;
            height: 16px;
            background: #ef4444;
            border-radius: 50%;
            margin-right: 12px;
            animation: ping 1s infinite;
        }

        @keyframes ping {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }

        .recording-text {
            color: #dc2626;
            font-weight: bold;
            font-size: 18px;
        }

        .vitamin-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 16px;
            margin-bottom: 32px;
        }

        .vitamin-card {
            padding: 24px;
            border: 2px solid #e5e7eb;
            border-radius: 12px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s;
        }

        .vitamin-card:hover {
            transform: scale(1.05);
            border-color: #14b8a6;
        }

        .vitamin-icon {
            width: 64px;
            height: 64px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 12px;
            font-size: 32px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        }

        .vitamin-name {
            font-size: 18px;
            font-weight: bold;
            color: #1f2937;
        }

        .payment-option {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 24px;
            border: 2px solid #e5e7eb;
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s;
            margin-bottom: 16px;
        }

        .payment-option:hover {
            border-color: #14b8a6;
            background: #f0fdfa;
            transform: scale(1.05);
        }

        .payment-left {
            display: flex;
            align-items: center;
        }

        .payment-icon {
            width: 48px;
            height: 48px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-right: 16px;
        }

        .payment-icon.purple {
            background: #f3e8ff;
        }

        .payment-icon.green {
            background: #d1fae5;
        }

        .payment-icon svg {
            width: 24px;
            height: 24px;
        }

        .payment-text {
            font-size: 18px;
            font-weight: bold;
            color: #1f2937;
        }

        .payment-arrow {
            color: #9ca3af;
            font-size: 24px;
        }

        .selected-vitamin {
            display: inline-block;
            background: #ccfbf1;
            padding: 12px 24px;
            border-radius: 999px;
            margin-bottom: 32px;
        }

        .selected-vitamin-label {
            font-size: 14px;
            color: #6b7280;
        }

        .selected-vitamin-name {
            font-size: 20px;
            font-weight: bold;
            color: #14b8a6;
        }

        .qr-box {
            padding: 32px;
            background: white;
            border: 4px solid #e9d5ff;
            border-radius: 16px;
            margin-bottom: 32px;
        }

        .qr-placeholder {
            aspect-ratio: 1;
            background: linear-gradient(135deg, #f3e8ff 0%, #fce7f3 100%);
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .qr-placeholder svg {
            width: 128px;
            height: 128px;
            stroke: #a855f7;
        }

        .method-badge {
            background: #faf5ff;
            padding: 16px;
            border-radius: 12px;
            text-align: center;
            margin-bottom: 24px;
        }

        .method-label {
            font-size: 14px;
            color: #6b7280;
            margin-bottom: 4px;
        }

        .method-name {
            font-size: 18px;
            font-weight: bold;
            color: #a855f7;
        }

        .cash-icon {
            width: 96px;
            height: 96px;
            margin: 0 auto 16px;
        }

        .cash-icon svg {
            width: 96px;
            height: 96px;
            stroke: #10b981;
        }

        .form-label {
            display: block;
            font-size: 14px;
            font-weight: 600;
            color: #374151;
            margin-bottom: 8px;
        }

        .form-hint {
            font-size: 12px;
            color: #6b7280;
            margin-top: 8px;
        }

        .success-icon {
            animation: bounce 1s infinite;
        }

        @keyframes bounce {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-10px); }
        }

        .dispensing-box {
            background: linear-gradient(135deg, #dbeafe 0%, #ccfbf1 100%);
            border: 2px solid #5eead4;
            padding: 20px;
            border-radius: 12px;
        }

        .dispensing-header {
            display: flex;
            align-items: center;
            justify-content: center;
            margin-bottom: 8px;
        }

        .dispensing-header svg {
            width: 20px;
            height: 20px;
            stroke: #14b8a6;
            margin-right: 8px;
        }

        .dispensing-title {
            font-size: 18px;
            font-weight: 600;
            color: #1f2937;
        }

        .dispensing-text {
            font-size: 14px;
            color: #6b7280;
            text-align: center;
        }
    </style>
</head>
<body>
    <!-- Pantalla 1: Bienvenida -->
    <div id="welcome" class="screen active bg-teal">
        <div class="card card-center">
            <div style="margin-bottom: 32px;">
                <!-- Aqui va imagen 1 -->
               
            </div>
            <h1>¬°HOLA!</h1>
            <div class="brand">Vitaclick</div>
            <p class="subtitle">Smart Wellness</p>
            <button class="btn" onclick="showScreen('question')">COMENZAR</button>
        </div>
    </div>

    <!-- Pantalla 2: S√≠ntomas -->
    <div id="question" class="screen bg-teal">
        <div class="card">
            <div class="icon-circle small">
                <svg viewBox="0 0 24 24"><polyline points="22 12 18 12 15 21 9 3 6 12 2 12"></polyline></svg>
            </div>
            <h2>¬øQu√© s√≠ntomas presentas?</h2>
            
            <div id="recordingBanner" style="display: none;">
                <div class="recording-banner">
                    <div class="recording-indicator">
                        <div class="recording-dot"></div>
                        <span class="recording-text">üé§ GRABANDO</span>
                    </div>
                    <p style="color: #dc2626; text-align: center; font-weight: 600;">Habla claramente ahora...</p>
                    <p style="font-size: 13px; color: #6b7280; text-align: center; margin-top: 4px;">Haz clic de nuevo en el micr√≥fono para detener</p>
                    <p style="font-size: 12px; color: #9ca3af; text-align: center; margin-top: 2px;">‚è±Ô∏è M√°ximo 8 segundos</p>
                </div>
            </div>

            <div class="textarea-container">
                <textarea id="symptoms" placeholder="Escribe aqu√≠ o usa el micr√≥fono..."></textarea>
                <button id="micButton" class="mic-button" onclick="handleMic()">
                    <svg viewBox="0 0 24 24"><path d="M12 1a3 3 0 0 0-3 3v8a3 3 0 0 0 6 0V4a3 3 0 0 0-3-3z"></path><path d="M19 10v2a7 7 0 0 1-14 0v-2"></path><line x1="12" y1="19" x2="12" y2="23"></line><line x1="8" y1="23" x2="16" y2="23"></line></svg>
                </button>
            </div>

            <div class="alert alert-blue">
                <p class="alert-text">
                    <strong>üé§ Instrucciones:</strong><br/>
                    1. Presiona el bot√≥n del micr√≥fono<br/>
                    2. Permite el acceso cuando te lo pida<br/>
                    3. Habla claramente<br/>
                    4. El texto aparecer√° autom√°ticamente
                </p>
            </div>

            <button class="btn" onclick="goToDiagnosis()">CONTINUAR</button>
        </div>
    </div>

    <!-- Pantalla 3: Diagn√≥stico -->
    <div id="diagnosis" class="screen bg-teal">
        <div class="card">
            <div class="icon-circle small">
                <svg viewBox="0 0 24 24"><rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect><circle cx="8.5" cy="8.5" r="1.5"></circle><polyline points="21 15 16 10 5 21"></polyline></svg>
            </div>
            
            <div class="alert alert-teal">
                <p class="alert-title">Recomendaci√≥n:</p>
                <p class="alert-text">
                    Para tus s√≠ntomas te recomiendo consumir <strong style="color: #14b8a6;">zinc en c√°psulas por 3 d√≠as</strong>. 
                    Tras ello, consulta a tu m√©dico para un mejor diagn√≥stico.
                </p>
            </div>

            <h2>Elige alguna vitamina</h2>

            <div class="vitamin-grid">
                <div class="vitamin-card" onclick="selectVitamin('hierro', 'Hierro')">
                    <div class="vitamin-icon" style="background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%);">‚ö°</div>
                    <div class="vitamin-name">Hierro</div>
                </div>
                <div class="vitamin-card" onclick="selectVitamin('b12', 'B12')">
                    <div class="vitamin-icon" style="background: linear-gradient(135deg, #3b82f6 0%, #2563eb 100%);">üíä</div>
                    <div class="vitamin-name">B12</div>
                </div>
                <div class="vitamin-card" onclick="selectVitamin('zinc', 'Zinc')">
                    <div class="vitamin-icon" style="background: linear-gradient(135deg, #a855f7 0%, #9333ea 100%);">‚ú®</div>
                    <div class="vitamin-name">Zinc</div>
                </div>
                <div class="vitamin-card" onclick="selectVitamin('vitaminac', 'Vitamina C')">
                    <div class="vitamin-icon" style="background: linear-gradient(135deg, #f97316 0%, #ea580c 100%);">üçä</div>
                    <div class="vitamin-name">Vitamina C</div>
                </div>
            </div>
        </div>
    </div>

    <!-- Pantalla 4: M√©todo de Pago -->
    <div id="payment" class="screen bg-teal">
        <div class="card">
            <div class="selected-vitamin">
                <p class="selected-vitamin-label">Vitamina seleccionada:</p>
                <p class="selected-vitamin-name" id="selectedVitaminPayment">-</p>
            </div>

            <h2>Escoge m√©todo de pago</h2>

            <div class="payment-option" onclick="selectPayment('yape')">
                <div class="payment-left">
                    <div class="payment-icon purple">
                        <svg viewBox="0 0 24 24" fill="none" stroke="#a855f7" stroke-width="2"><rect x="3" y="3" width="18" height="18"></rect><path d="M9 9h6v6H9z"></path></svg>
                    </div>
                    <span class="payment-text">Yape / Plin</span>
                </div>
                <div class="payment-arrow">‚Üí</div>
            </div>

            <div class="payment-option" onclick="selectPayment('cash')">
                <div class="payment-left">
                    <div class="payment-icon green">
                        <svg viewBox="0 0 24 24" fill="none" stroke="#10b981" stroke-width="2"><circle cx="12" cy="12" r="8"></circle><line x1="12" y1="8" x2="12" y2="12"></line><line x1="12" y1="16" x2="12.01" y2="16"></line></svg>
                    </div>
                    <span class="payment-text">Efectivo</span>
                </div>
                <div class="payment-arrow">‚Üí</div>
            </div>
        </div>
    </div>

    <!-- Pantalla 5: Yape QR -->
    <div id="yape" class="screen bg-purple">
        <div class="card card-center">
            <div class="selected-vitamin" style="background: #f3e8ff;">
                <p class="selected-vitamin-label">Vitamina seleccionada:</p>
                <p class="selected-vitamin-name" id="selectedVitaminYape" style="color: #a855f7;">-</p>
            </div>

            <h2>Realice el pago</h2>
            <p style="color: #6b7280; margin-bottom: 32px;">Escanea el c√≥digo QR</p>

            <div class="qr-box">
                 <!-- Aqui va imagen 2 -->
                
            </div>

            <div class="method-badge">
                <p class="method-label">M√©todo de pago</p>
                <p class="method-name">YAPE / PLIN</p>
            </div>

            <button class="btn btn-purple" onclick="showScreen('yapeValidation')">CONTINUAR</button>
        </div>
    </div>

    <!-- Pantalla 6: Validaci√≥n Yape -->
    <div id="yapeValidation" class="screen bg-purple">
        <div class="card">
            <div class="selected-vitamin" style="background: #f3e8ff;">
                <p class="selected-vitamin-label">Vitamina seleccionada:</p>
                <p class="selected-vitamin-name" id="selectedVitaminYapeVal" style="color: #a855f7;">-</p>
            </div>

            <div class="icon-circle small purple">
                <svg viewBox="0 0 24 24" fill="none" stroke-width="2"><rect x="3" y="3" width="18" height="18"></rect><path d="M9 9h6v6H9z"></path></svg>
            </div>

            <h2>Validaci√≥n de pago</h2>
            <p style="color: #6b7280; text-align: center; margin-bottom: 32px;">Ingresa tu nombre registrado en Yape</p>

            <div id="recordingBannerYape" style="display: none;">
                <div class="recording-banner">
                    <div class="recording-indicator">
                        <div class="recording-dot"></div>
                        <span class="recording-text">üé§ GRABANDO</span>
                    </div>
                    <p style="color: #dc2626; text-align: center; font-weight: 600;">Di tu nombre completo...</p>
                    <p style="font-size: 13px; color: #6b7280; text-align: center; margin-top: 4px;">Clic de nuevo para detener</p>
                </div>
            </div>

            <div class="form-group">
                <label class="form-label">Nombre en YAPE</label>
                <div style="position: relative;">
                    <input type="text" id="yapeUserName" placeholder="Tu nombre completo" class="input-purple" style="padding-right: 60px;">
                    <button id="micButtonYape" class="mic-button" onclick="handleMicYape()" style="bottom: 8px; right: 8px; width: 48px; height: 48px; background: linear-gradient(135deg, #a855f7 0%, #ec4899 100%);">
                        <svg viewBox="0 0 24 24"><path d="M12 1a3 3 0 0 0-3 3v8a3 3 0 0 0 6 0V4a3 3 0 0 0-3-3z"></path><path d="M19 10v2a7 7 0 0 1-14 0v-2"></path><line x1="12" y1="19" x2="12" y2="23"></line><line x1="8" y1="23" x2="16" y2="23"></line></svg>
                    </button>
                </div>
                <p class="form-hint">* Debe coincidir con tu cuenta Yape o usa el micr√≥fono üé§</p>
            </div>

            <button class="btn btn-purple" onclick="confirmYape()">VALIDAR Y CONFIRMAR</button>
        </div>
    </div>

    <!-- Pantalla 7: Efectivo -->
    <div id="cash" class="screen bg-green">
        <div class="card">
            <div class="selected-vitamin" style="background: #d1fae5;">
                <p class="selected-vitamin-label">Vitamina seleccionada:</p>
                <p class="selected-vitamin-name" id="selectedVitaminCash" style="color: #10b981;">-</p>
            </div>

            <h2 style="text-align: center;">Pago en efectivo</h2>
            <p style="color: #6b7280; text-align: center; margin-bottom: 32px;">Ingresa las monedas y tu nombre</p>

            <div class="alert" style="background: #d1fae5; padding: 32px; border-radius: 16px; margin-bottom: 24px; text-align: center;">
                <div class="cash-icon">
                    <svg viewBox="0 0 24 24" fill="none" stroke-width="2"><circle cx="12" cy="12" r="8"></circle><line x1="12" y1="8" x2="12" y2="12"></line><line x1="12" y1="16" x2="12.01" y2="16"></line></svg>
                </div>
                <p style="font-size: 18px; color: #374151;">Inserta las monedas en la ranura inferior</p>
            </div>

            <div id="recordingBannerCash" style="display: none;">
                <div class="recording-banner" style="background: #d1fae5; border-color: #34d399;">
                    <div class="recording-indicator">
                        <div class="recording-dot"></div>
                        <span class="recording-text">üé§ GRABANDO</span>
                    </div>
                    <p style="color: #dc2626; text-align: center; font-weight: 600;">Di tu nombre completo...</p>
                    <p style="font-size: 13px; color: #6b7280; text-align: center; margin-top: 4px;">Clic de nuevo para detener</p>
                </div>
            </div>

            <div class="form-group">
                <label class="form-label">Ingresa tu nombre</label>
                <div style="position: relative;">
                    <input type="text" id="cashUserName" placeholder="Tu nombre" class="input-green" style="padding-right: 60px;">
                    <button id="micButtonCash" class="mic-button" onclick="handleMicCash()" style="bottom: 8px; right: 8px; width: 48px; height: 48px; background: linear-gradient(135deg, #10b981 0%, #059669 100%);">
                        <svg viewBox="0 0 24 24"><path d="M12 1a3 3 0 0 0-3 3v8a3 3 0 0 0 6 0V4a3 3 0 0 0-3-3z"></path><path d="M19 10v2a7 7 0 0 1-14 0v-2"></path><line x1="12" y1="19" x2="12" y2="23"></line><line x1="8" y1="23" x2="16" y2="23"></line></svg>
                    </button>
                </div>
                <p class="form-hint">Escribe tu nombre o usa el micr√≥fono üé§</p>
            </div>

            <button class="btn btn-green" onclick="confirmCash()">CONFIRMAR PAGO</button>
        </div>
    </div>

    <!-- Pantalla 8: Gracias -->
    <div id="thanks" class="screen bg-teal">
        <div class="card card-center">
            <div class="icon-circle success-icon">
                <svg viewBox="0 0 24 24"><polyline points="20 6 9 17 4 12"></polyline></svg>
            </div>
            <h1 style="font-size: 40px;">¬°Muchas gracias!</h1>
            <!-- Imagen 3 -->
           
            <p style="color: #6b7280; margin-bottom: 16px;">Tu compra ha sido procesada exitosamente</p>
            
            <div class="selected-vitamin" style="margin-bottom: 24px;">
                <p class="selected-vitamin-label">Vitamina adquirida:</p>
                <p class="selected-vitamin-name" id="selectedVitaminThanks">-</p>
            </div>

            <div class="dispensing-box" style="margin-bottom: 32px;">
                <div class="dispensing-header">
                    <svg viewBox="0 0 24 24" fill="none" stroke-width="2"><rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect><circle cx="8.5" cy="8.5" r="1.5"></circle><polyline points="21 15 16 10 5 21"></polyline></svg>
                    <p class="dispensing-title">Su vitamina se dispensar√° en unos minutos</p>
                </div>
                <p class="dispensing-text">Por favor espere cerca del dispensador</p>
            </div>

            <button class="btn btn-gray" onclick="resetApp()">NUEVA COMPRA</button>
        </div>
    </div>

    <script>
        // Variables globales
        let selectedVitamin = null;
        let symptoms = '';
        let isRecording = false;

        // Navegaci√≥n entre pantallas
        function showScreen(screenId) {
            document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
            document.getElementById(screenId).classList.add('active');
        }

        // Reconocimiento de voz
        let currentRecognition = null;
        let recognitionTimeout = null;
        
        function handleMic() {
            console.log('=================================');
            console.log('üîµ Bot√≥n de micr√≥fono presionado');
            console.log('üåê Protocolo:', window.location.protocol);
            console.log('üåê Host:', window.location.host);
            console.log('üåê Online:', navigator.onLine);
            
            // Verificar conectividad
            if (!navigator.onLine) {
                alert('‚ùå Sin conexi√≥n a internet\n\nEl reconocimiento de voz requiere conexi√≥n activa.\nConecta a internet e intenta de nuevo.');
                return;
            }
            
            // Advertencia sobre contexto no seguro
            const protocol = window.location.protocol;
            const isSecure = protocol === 'https:' || 
                           window.location.hostname === 'localhost' || 
                           window.location.hostname === '127.0.0.1' ||
                           protocol === 'file:';
            
            if (!isSecure) {
                console.warn('‚ö†Ô∏è Contexto no seguro:', protocol);
                alert('‚ö†Ô∏è ADVERTENCIA\n\nEst√°s usando HTTP (no seguro).\nEl reconocimiento de voz puede no funcionar correctamente.\n\nRecomendaciones:\n‚Ä¢ Usa HTTPS en producci√≥n\n‚Ä¢ Prueba en localhost\n‚Ä¢ O abre el archivo directamente');
            }
            
            // Si ya est√° grabando, detener
            if (isRecording && currentRecognition) {
                console.log('‚èπÔ∏è Deteniendo grabaci√≥n manual');
                currentRecognition.stop();
                return;
            }
            
            const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
            
            if (!SpeechRecognition) {
                console.log('‚ùå SpeechRecognition NO disponible');
                const userAgent = navigator.userAgent;
                let browserMsg = '';
                
                if (userAgent.includes('Firefox')) {
                    browserMsg = '\n\n‚ö†Ô∏è Est√°s usando Firefox.\nFirefox tiene soporte limitado.\n\nUSA CHROME para mejor compatibilidad.';
                } else if (userAgent.includes('Safari') && !userAgent.includes('Chrome')) {
                    browserMsg = '\n\n‚ÑπÔ∏è Safari requiere iOS 14.5+ o macOS 11+';
                }
                
                alert('‚ùå Tu navegador no soporta reconocimiento de voz.' + browserMsg + '\n\nNavegadores compatibles:\n‚Ä¢ Google Chrome ‚úÖ (recomendado)\n‚Ä¢ Microsoft Edge ‚úÖ\n‚Ä¢ Safari ‚úÖ (versiones recientes)');
                return;
            }
            
            console.log('‚úÖ SpeechRecognition disponible');
            
            const recognition = new SpeechRecognition();
            currentRecognition = recognition;
            
            recognition.lang = 'es-ES';
            recognition.continuous = true;
            recognition.interimResults = true;
            recognition.maxAlternatives = 1;
            
            console.log('‚úÖ Configuraci√≥n:');
            console.log('   - Idioma:', recognition.lang);
            console.log('   - Continuo:', recognition.continuous);
            console.log('   - Resultados intermedios:', recognition.interimResults);
            
            const textarea = document.getElementById('symptoms');
            const micButton = document.getElementById('micButton');
            const banner = document.getElementById('recordingBanner');
            
            let finalTranscript = '';
            let interimTranscript = '';
            let hasReceivedResults = false;
            
            recognition.onstart = () => {
                console.log('üé§ GRABACI√ìN INICIADA');
                isRecording = true;
                micButton.disabled = false;
                micButton.style.background = 'linear-gradient(135deg, #ef4444 0%, #dc2626 100%)';
                banner.style.display = 'block';
                
                // Timeout de seguridad (10 segundos)
                recognitionTimeout = setTimeout(() => {
                    console.log('‚è∞ Timeout alcanzado, deteniendo...');
                    recognition.stop();
                }, 10000);
            };
            
            recognition.onspeechstart = () => {
                console.log('üó£Ô∏è Voz detectada - empezando a escuchar');
            };
            
            recognition.onspeechend = () => {
                console.log('ü§ê Silencio detectado - fin de voz');
            };
            
            recognition.onresult = (event) => {
                console.log('üìù Evento onresult disparado');
                hasReceivedResults = true;
                interimTranscript = '';
                
                for (let i = event.resultIndex; i < event.results.length; i++) {
                    const transcript = event.results[i][0].transcript;
                    
                    if (event.results[i].isFinal) {
                        console.log('‚úÖ Resultado FINAL:', transcript);
                        finalTranscript += transcript + ' ';
                    } else {
                        console.log('‚è≥ Resultado intermedio:', transcript);
                        interimTranscript += transcript;
                    }
                }
                
                // Actualizar el textarea con resultados en tiempo real
                const currentText = textarea.value.trim();
                const baseText = currentText.replace(interimTranscript, '').trim();
                textarea.value = baseText ? `${baseText} ${finalTranscript}${interimTranscript}`.trim() : `${finalTranscript}${interimTranscript}`.trim();
                
                console.log('üìã Texto actual en textarea:', textarea.value);
            };
            
            recognition.onerror = (event) => {
                console.log('‚ùå ERROR:', event.error);
                console.log('üìä Online status:', navigator.onLine);
                console.log('üìä Recibi√≥ resultados:', hasReceivedResults);
                
                clearTimeout(recognitionTimeout);
                
                let errorMsg = '';
                switch(event.error) {
                    case 'not-allowed':
                    case 'permission-denied':
                        errorMsg = 'üö´ PERMISO DENEGADO\n\nPasos para solucionarlo:\n\n1. Haz clic en el √≠cono del candado üîí (junto a la URL)\n2. Busca "Micr√≥fono"\n3. Selecciona "Permitir"\n4. RECARGA LA P√ÅGINA (F5)\n5. Intenta de nuevo';
                        break;
                    case 'no-speech':
                        console.log('‚ÑπÔ∏è No se detect√≥ voz, pero continuando...');
                        return;
                    case 'audio-capture':
                        errorMsg = 'üé§ NO SE PUEDE ACCEDER AL MICR√ìFONO\n\nVerifica:\n\n1. El micr√≥fono est√° conectado\n2. No lo est√° usando otra app (Zoom, Teams, etc.)\n3. En Windows: Configuraci√≥n > Privacidad > Micr√≥fono\n4. Prueba el micr√≥fono en otra app primero';
                        break;
                    case 'network':
                        errorMsg = 'üåê ERROR DE RED\n\nPosibles causas:\n\n1. Firewall bloqueando Google Speech API\n2. Antivirus/Bloqueador de anuncios activo\n3. Proxy corporativo\n4. VPN interfiriendo\n\nSoluciones:\n‚Ä¢ Desactiva bloqueadores de anuncios\n‚Ä¢ Desactiva VPN temporalmente\n‚Ä¢ Prueba con datos m√≥viles\n‚Ä¢ Usa Chrome en modo Inc√≥gnito\n\nO simplemente escribe manualmente.';
                        break;
                    case 'aborted':
                        console.log('‚ÑπÔ∏è Grabaci√≥n detenida por el usuario');
                        return;
                    case 'service-not-allowed':
                        errorMsg = 'üö´ SERVICIO NO PERMITIDO\n\nEsto puede pasar si:\n‚Ä¢ El sitio no usa HTTPS\n‚Ä¢ Est√°s en modo inc√≥gnito\n‚Ä¢ El navegador bloquea el servicio\n\nIntenta:\n1. Abrir en ventana normal (no inc√≥gnito)\n2. Usar HTTPS\n3. Escribir manualmente';
                        break;
                    default:
                        errorMsg = `‚ö†Ô∏è ERROR: ${event.error}\n\n`;
                        if (!navigator.onLine) {
                            errorMsg += '‚ùå Sin conexi√≥n a internet detectada\n\n';
                        }
                        errorMsg += 'Contexto:\n';
                        errorMsg += `‚Ä¢ Protocolo: ${window.location.protocol}\n`;
                        errorMsg += `‚Ä¢ Online: ${navigator.onLine ? 'S√≠' : 'No'}\n`;
                        errorMsg += `‚Ä¢ Navegador: ${navigator.userAgent.includes('Chrome') ? 'Chrome' : navigator.userAgent.includes('Firefox') ? 'Firefox' : 'Otro'}\n\n`;
                        errorMsg += 'Intenta escribir manualmente.';
                }
                
                if (errorMsg) alert(errorMsg);
                
                isRecording = false;
                currentRecognition = null;
                micButton.disabled = false;
                micButton.style.background = 'linear-gradient(135deg, #14b8a6 0%, #10b981 100%)';
                banner.style.display = 'none';
            };
            
            recognition.onend = () => {
                console.log('üõë Grabaci√≥n terminada');
                console.log('üìÑ Texto final capturado:', finalTranscript.trim());
                console.log('üìä Recibi√≥ resultados:', hasReceivedResults);
                
                clearTimeout(recognitionTimeout);
                
                // Guardar el texto final
                if (finalTranscript.trim()) {
                    const currentText = textarea.value.trim();
                    textarea.value = currentText ? `${currentText} ${finalTranscript.trim()}` : finalTranscript.trim();
                    symptoms = textarea.value;
                    console.log('üíæ Texto guardado en textarea');
                } else if (!hasReceivedResults) {
                    console.warn('‚ö†Ô∏è No se recibieron resultados');
                }
                
                isRecording = false;
                currentRecognition = null;
                micButton.disabled = false;
                micButton.style.background = 'linear-gradient(135deg, #14b8a6 0%, #10b981 100%)';
                banner.style.display = 'none';
            };
            
            try {
                console.log('‚ñ∂Ô∏è Iniciando grabaci√≥n...');
                recognition.start();
                console.log('‚úÖ Reconocimiento iniciado correctamente');
            } catch (error) {
                console.log('üí• EXCEPCI√ìN al iniciar:', error.message);
                alert(`‚ö†Ô∏è Error al iniciar:\n${error.message}\n\nIntenta:\n1. Recargar la p√°gina\n2. Dar permisos al micr√≥fono\n3. Usar Chrome\n4. O escribir manualmente`);
                isRecording = false;
                currentRecognition = null;
                micButton.disabled = false;
                banner.style.display = 'none';
                clearTimeout(recognitionTimeout);
            }
            
            console.log('=================================');
        }

        // Reconocimiento de voz para Yape
        let currentRecognitionYape = null;
        let recognitionTimeoutYape = null;
        
        function handleMicYape() {
            console.log('üé§ Micr√≥fono Yape activado');
            console.log('üåê Online:', navigator.onLine);
            
            if (!navigator.onLine) {
                alert('‚ùå Sin conexi√≥n a internet\n\nConecta a internet e intenta de nuevo.');
                return;
            }
            
            // Si ya est√° grabando, detener
            if (currentRecognitionYape) {
                console.log('‚èπÔ∏è Deteniendo grabaci√≥n Yape');
                currentRecognitionYape.stop();
                return;
            }
            
            const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
            
            if (!SpeechRecognition) {
                alert('‚ùå Tu navegador no soporta reconocimiento de voz.\n\nUSA CHROME para mejor compatibilidad.\n\nNavegadores compatibles:\n‚Ä¢ Chrome ‚úÖ\n‚Ä¢ Edge ‚úÖ\n‚Ä¢ Safari ‚úÖ');
                return;
            }
            
            const recognition = new SpeechRecognition();
            currentRecognitionYape = recognition;
            
            recognition.lang = 'es-ES';
            recognition.continuous = true;
            recognition.interimResults = true;
            recognition.maxAlternatives = 1;
            
            const input = document.getElementById('yapeUserName');
            const micButton = document.getElementById('micButtonYape');
            const banner = document.getElementById('recordingBannerYape');
            
            let finalTranscript = '';
            
            recognition.onstart = () => {
                console.log('üé§ Grabando nombre Yape...');
                micButton.disabled = false;
                micButton.style.background = 'linear-gradient(135deg, #ef4444 0%, #dc2626 100%)';
                banner.style.display = 'block';
                
                recognitionTimeoutYape = setTimeout(() => {
                    console.log('‚è∞ Timeout Yape');
                    recognition.stop();
                }, 6000);
            };
            
            recognition.onresult = (event) => {
                let interimTranscript = '';
                
                for (let i = event.resultIndex; i < event.results.length; i++) {
                    const transcript = event.results[i][0].transcript;
                    
                    if (event.results[i].isFinal) {
                        console.log('‚úÖ Nombre capturado:', transcript);
                        finalTranscript += transcript + ' ';
                    } else {
                        interimTranscript += transcript;
                    }
                }
                
                input.value = (finalTranscript + interimTranscript).trim();
            };
            
            recognition.onerror = (event) => {
                console.error('‚ùå Error Yape:', event.error);
                console.log('üìä Online:', navigator.onLine);
                clearTimeout(recognitionTimeoutYape);
                
                if (event.error === 'no-speech' || event.error === 'aborted') {
                    console.log('‚ÑπÔ∏è Continuando...');
                    return;
                }
                
                let errorMsg = '';
                switch(event.error) {
                    case 'not-allowed':
                    case 'permission-denied':
                        errorMsg = 'üö´ Permiso denegado.\n\nHaz clic en el candado üîí junto a la URL\ny permite el acceso al micr√≥fono.\nLuego recarga la p√°gina (F5).';
                        break;
                    case 'audio-capture':
                        errorMsg = 'üé§ No se puede acceder al micr√≥fono.\n\nVerifica que est√© conectado\ny no lo est√© usando otra app.';
                        break;
                    case 'network':
                        errorMsg = 'üåê Error de red.\n\nPuede ser:\n‚Ä¢ Firewall bloqueando\n‚Ä¢ Bloqueador de anuncios\n‚Ä¢ VPN interfiriendo\n\nIntenta desactivarlos\no escribe manualmente.';
                        break;
                    default:
                        errorMsg = `‚ö†Ô∏è Error: ${event.error}\n\nOnline: ${navigator.onLine ? 'S√≠' : 'No'}\n\nEscribe manualmente tu nombre.`;
                }
                
                if (errorMsg) alert(errorMsg);
                
                currentRecognitionYape = null;
                micButton.disabled = false;
                micButton.style.background = 'linear-gradient(135deg, #a855f7 0%, #ec4899 100%)';
                banner.style.display = 'none';
            };
            
            recognition.onend = () => {
                console.log('üõë Grabaci√≥n Yape terminada');
                clearTimeout(recognitionTimeoutYape);
                
                if (finalTranscript.trim()) {
                    input.value = finalTranscript.trim();
                    console.log('üíæ Nombre guardado:', input.value);
                }
                
                currentRecognitionYape = null;
                micButton.disabled = false;
                micButton.style.background = 'linear-gradient(135deg, #a855f7 0%, #ec4899 100%)';
                banner.style.display = 'none';
            };
            
            try {
                recognition.start();
            } catch (error) {
                console.error('üí• Error al iniciar Yape:', error);
                alert(`‚ö†Ô∏è Error: ${error.message}\n\nIntenta escribir manualmente.`);
                currentRecognitionYape = null;
                micButton.disabled = false;
                micButton.style.background = 'linear-gradient(135deg, #a855f7 0%, #ec4899 100%)';
                banner.style.display = 'none';
                clearTimeout(recognitionTimeoutYape);
            }
        }

        // Reconocimiento de voz para Efectivo
        let currentRecognitionCash = null;
        let recognitionTimeoutCash = null;
        
        function handleMicCash() {
            console.log('üé§ Micr√≥fono Efectivo activado');
            console.log('üåê Online:', navigator.onLine);
            
            if (!navigator.onLine) {
                alert('‚ùå Sin conexi√≥n a internet\n\nConecta a internet e intenta de nuevo.');
                return;
            }
            
            // Si ya est√° grabando, detener
            if (currentRecognitionCash) {
                console.log('‚èπÔ∏è Deteniendo grabaci√≥n Efectivo');
                currentRecognitionCash.stop();
                return;
            }
            
            const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
            
            if (!SpeechRecognition) {
                alert('‚ùå Tu navegador no soporta reconocimiento de voz.\n\nUSA CHROME para mejor compatibilidad.\n\nNavegadores compatibles:\n‚Ä¢ Chrome ‚úÖ\n‚Ä¢ Edge ‚úÖ\n‚Ä¢ Safari ‚úÖ');
                return;
            }
            
            const recognition = new SpeechRecognition();
            currentRecognitionCash = recognition;
            
            recognition.lang = 'es-ES';
            recognition.continuous = true;
            recognition.interimResults = true;
            recognition.maxAlternatives = 1;
            
            const input = document.getElementById('cashUserName');
            const micButton = document.getElementById('micButtonCash');
            const banner = document.getElementById('recordingBannerCash');
            
            let finalTranscript = '';
            
            recognition.onstart = () => {
                console.log('üé§ Grabando nombre Efectivo...');
                micButton.disabled = false;
                micButton.style.background = 'linear-gradient(135deg, #ef4444 0%, #dc2626 100%)';
                banner.style.display = 'block';
                
                recognitionTimeoutCash = setTimeout(() => {
                    console.log('‚è∞ Timeout Efectivo');
                    recognition.stop();
                }, 6000);
            };
            
            recognition.onresult = (event) => {
                let interimTranscript = '';
                
                for (let i = event.resultIndex; i < event.results.length; i++) {
                    const transcript = event.results[i][0].transcript;
                    
                    if (event.results[i].isFinal) {
                        console.log('‚úÖ Nombre capturado:', transcript);
                        finalTranscript += transcript + ' ';
                    } else {
                        interimTranscript += transcript;
                    }
                }
                
                input.value = (finalTranscript + interimTranscript).trim();
            };
            
            recognition.onerror = (event) => {
                console.error('‚ùå Error Efectivo:', event.error);
                console.log('üìä Online:', navigator.onLine);
                clearTimeout(recognitionTimeoutCash);
                
                if (event.error === 'no-speech' || event.error === 'aborted') {
                    console.log('‚ÑπÔ∏è Continuando...');
                    return;
                }
                
                let errorMsg = '';
                switch(event.error) {
                    case 'not-allowed':
                    case 'permission-denied':
                        errorMsg = 'üö´ Permiso denegado.\n\nHaz clic en el candado üîí junto a la URL\ny permite el acceso al micr√≥fono.\nLuego recarga la p√°gina (F5).';
                        break;
                    case 'audio-capture':
                        errorMsg = 'üé§ No se puede acceder al micr√≥fono.\n\nVerifica que est√© conectado\ny no lo est√© usando otra app.';
                        break;
                    case 'network':
                        errorMsg = 'üåê Error de red.\n\nPuede ser:\n‚Ä¢ Firewall bloqueando\n‚Ä¢ Bloqueador de anuncios\n‚Ä¢ VPN interfiriendo\n\nIntenta desactivarlos\no escribe manualmente.';
                        break;
                    default:
                        errorMsg = `‚ö†Ô∏è Error: ${event.error}\n\nOnline: ${navigator.onLine ? 'S√≠' : 'No'}\n\nEscribe manualmente tu nombre.`;
                }
                
                if (errorMsg) alert(errorMsg);
                
                currentRecognitionCash = null;
                micButton.disabled = false;
                micButton.style.background = 'linear-gradient(135deg, #10b981 0%, #059669 100%)';
                banner.style.display = 'none';
            };
            
            recognition.onend = () => {
                console.log('üõë Grabaci√≥n Efectivo terminada');
                clearTimeout(recognitionTimeoutCash);
                
                if (finalTranscript.trim()) {
                    input.value = finalTranscript.trim();
                    console.log('üíæ Nombre guardado:', input.value);
                }
                
                currentRecognitionCash = null;
                micButton.disabled = false;
                micButton.style.background = 'linear-gradient(135deg, #10b981 0%, #059669 100%)';
                banner.style.display = 'none';
            };
            
            try {
                recognition.start();
            } catch (error) {
                console.error('üí• Error al iniciar Efectivo:', error);
                alert(`‚ö†Ô∏è Error: ${error.message}\n\nIntenta escribir manualmente.`);
                currentRecognitionCash = null;
                micButton.disabled = false;
                micButton.style.background = 'linear-gradient(135deg, #10b981 0%, #059669 100%)';
                banner.style.display = 'none';
                clearTimeout(recognitionTimeoutCash);
            }
        }

        // Ir a diagn√≥stico
        function goToDiagnosis() {
            const textarea = document.getElementById('symptoms');
            if (!textarea.value.trim()) {
                alert('Por favor, describe tus s√≠ntomas');
                return;
            }
            symptoms = textarea.value;
            showScreen('diagnosis');
        }

        // Seleccionar vitamina
        function selectVitamin(id, name) {
            selectedVitamin = { id, name };
            showScreen('payment');
            document.getElementById('selectedVitaminPayment').textContent = name;
        }

        // Seleccionar m√©todo de pago
        function selectPayment(method) {
            if (method === 'yape') {
                document.getElementById('selectedVitaminYape').textContent = selectedVitamin.name;
                document.getElementById('selectedVitaminYapeVal').textContent = selectedVitamin.name;
                showScreen('yape');
            } else {
                document.getElementById('selectedVitaminCash').textContent = selectedVitamin.name;
                showScreen('cash');
            }
        }

        // Confirmar Yape
        function confirmYape() {
            const userName = document.getElementById('yapeUserName').value;
            if (!userName.trim()) {
                alert('Por favor, ingresa tu nombre');
                return;
            }
            document.getElementById('selectedVitaminThanks').textContent = selectedVitamin.name;
            showScreen('thanks');
        }

        // Confirmar Efectivo
        function confirmCash() {
            const userName = document.getElementById('cashUserName').value;
            if (!userName.trim()) {
                alert('Por favor, ingresa tu nombre');
                return;
            }
            document.getElementById('selectedVitaminThanks').textContent = selectedVitamin.name;
            showScreen('thanks');
        }

        // Reiniciar aplicaci√≥n
        function resetApp() {
            selectedVitamin = null;
            symptoms = '';
            document.getElementById('symptoms').value = '';
            document.getElementById('yapeUserName').value = '';
            document.getElementById('cashUserName').value = '';
            showScreen('welcome');
        }

        console.log('‚úÖ VITACLICK cargado correctamente');
    </script>
</body>
</html>
